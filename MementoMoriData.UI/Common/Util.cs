using Ortega.Common.Enums;
using Ortega.Share.Enums;
using Ortega.Share.Enums.Battle.Skill;
using Ortega.Share.Enums.Story;
using SkillCategory = Ortega.Share.Enums.Battle.Skill.SkillCategory;

namespace MementoMoriData.UI.Common;

public static class Util
{
    private static Dictionary<string, Dictionary<long, string>> _enumValueCache = new();

    static Util()
    {
        AddEnumCache<ActiveSkillType>();
        AddEnumCache<AttackOptionSubType>();
        AddEnumCache<AttackOptionType>();
        AddEnumCache<EffectGroupType>();
        AddEnumCache<EffectType>();
        AddEnumCache<HitType>();
        AddEnumCache<HpEffectType>();
        AddEnumCache<PassiveTrigger>();
        AddEnumCache<PassiveType>();
        AddEnumCache<RemoveEffectType>();
        AddEnumCache<SkillCategory>();
        AddEnumCache<SkillDisplayType>();
        AddEnumCache<SubSetType>();
        AddEnumCache<TargetGroupType>();
        AddEnumCache<TargetSelectOptionType>();
        AddEnumCache<TargetSelectType>();

        AddEnumCache<StoryMapCommandEffectType>();
        AddEnumCache<StoryMapCommandType>();
        AddEnumCache<StoryObjectType>();
        
        AddEnumCache<VolumeType>();
        AddEnumCache<AccountSuspensionType>();
        AddEnumCache<ActivityMedalType>();
        AddEnumCache<AnimationType>();
        AddEnumCache<ApiStatusCode>();
        AddEnumCache<AppAssetVersionEnvType>();
        AddEnumCache<AppNotificationType>();
        AddEnumCache<AppsFlyerEventType>();
        AddEnumCache<ArcanaParameterType>();
        AddEnumCache<ArcanaSortType>();
        AddEnumCache<AttributeEnhancementItemType>();
        AddEnumCache<AutoBattleQuickBonusConditionType>();
        AddEnumCache<AutoSellRarityFlags>();
        AddEnumCache<BacktraceCustomAttributeType>();
        AddEnumCache<BacktraceFilterFlags>();
        AddEnumCache<BadgeImageType>();
        AddEnumCache<BadgeType>();
        AddEnumCache<BanChatType>();
        AddEnumCache<BaseParameterType>();
        AddEnumCache<BasePointOffsetType>();
        AddEnumCache<BattleActionAdditionalFlags>();
        AddEnumCache<BattleActionType>();
        AddEnumCache<BattleCommonSeType>();
        AddEnumCache<BattleDamageType>();
        AddEnumCache<BattleFieldCharacterGroupType>();
        AddEnumCache<BattleParameterType>();
        AddEnumCache<BattleRewardType>();
        AddEnumCache<BattleScheduleType>();
        AddEnumCache<BattleType>();
        AddEnumCache<BgmEventType>();
        AddEnumCache<BgmType>();
        AddEnumCache<BgmVolumeChangeType>();
        AddEnumCache<BingoType>();
        AddEnumCache<BlinkAnimationType>();
        AddEnumCache<BountyQuestAppearanceType>();
        AddEnumCache<BountyQuestConditionType>();
        AddEnumCache<BountyQuestPlayerType>();
        AddEnumCache<BountyQuestRarityFlags>();
        AddEnumCache<BountyQuestType>();
        AddEnumCache<ButtonSpriteType>();
        AddEnumCache<ButtonStyleType>();
        AddEnumCache<CastleType>();
        AddEnumCache<ChangeItemType>();
        AddEnumCache<ChangeParameterType>();
        AddEnumCache<CharacterBasePointType>();
        AddEnumCache<CharacterBlinkAssetType>();
        AddEnumCache<CharacterBloodType>();
        AddEnumCache<CharacterColorType>();
        AddEnumCache<CharacterDetailTransitionType>();
        AddEnumCache<CharacterDetailViewType>();
        AddEnumCache<CharacterFilterType>();
        AddEnumCache<CharacterIconSize>();
        AddEnumCache<CharacterPlayableActionType>();
        AddEnumCache<CharacterPossessionFlags>();
        AddEnumCache<CharacterRarityFlags>();
        AddEnumCache<CharacterSortType>();
        AddEnumCache<CharacterStrengtheningItemType>();
        AddEnumCache<CharacterTrainingMaterialType>();
        AddEnumCache<CharacterType>();
        AddEnumCache<CharacterVoiceCategory>();
        AddEnumCache<CharacterVoiceType>();
        AddEnumCache<ChatReactionType>();
        AddEnumCache<ChatType>();
        AddEnumCache<CheckMarkColorType>();
        AddEnumCache<ClientErrorCode>();
        AddEnumCache<CommandChainType>();
        AddEnumCache<CountdownTextFormatType>();
        AddEnumCache<CountryCodeType>();
        AddEnumCache<CurrencyType>();
        AddEnumCache<DateAddTimeType>();
        AddEnumCache<DeckUseContentType>();
        AddEnumCache<DeviceType>();
        AddEnumCache<DungeonBattleDifficultyType>();
        AddEnumCache<DungeonBattleGridState>();
        AddEnumCache<DungeonBattleGridType>();
        AddEnumCache<DungeonBattleRelicBattlePowerBonusTargetType>();
        AddEnumCache<DungeonBattleRelicRarityType>();
        AddEnumCache<EffectGroupIconType>();
        AddEnumCache<ElementBonusConditionType>();
        AddEnumCache<ElementBonusPhaseType>();
        AddEnumCache<ElementBonusType>();
        AddEnumCache<ElementClassificationType>();
        AddEnumCache<ElementTowerRankingType>();
        AddEnumCache<ElementType>();
        AddEnumCache<EmotionFlags>();
        AddEnumCache<EquipmentCategory>();
        AddEnumCache<EquipmentMedalType>();
        AddEnumCache<EquipmentRarityFlags>();
        AddEnumCache<EquipmentReinforcementItemType>();
        AddEnumCache<EquipmentSlotType>();
        AddEnumCache<ErrorHandlingType>();
        AddEnumCache<ErrorLevel>();
        AddEnumCache<ErrorLogType>();
        AddEnumCache<ErrorMessageType>();
        AddEnumCache<EventExchangePlaceItemType>();
        AddEnumCache<EvolutionType>();
        AddEnumCache<ExchangePlaceItemType>();
        AddEnumCache<ExchangePlaceType>();
        AddEnumCache<FontType>();
        AddEnumCache<FpsType>();
        AddEnumCache<FriendInfoType>();
        AddEnumCache<FriendStatusType>();
        AddEnumCache<GachaAddCharacterType>();
        AddEnumCache<GachaBonusGaugeType>();
        AddEnumCache<GachaCaseFlags>();
        AddEnumCache<GachaCategoryType>();
        AddEnumCache<GachaDestinyType>();
        AddEnumCache<GachaGroupType>();
        AddEnumCache<GachaRelicType>();
        AddEnumCache<GachaResetType>();
        AddEnumCache<GachaSelectListType>();
        AddEnumCache<GachaTicketType>();
        AddEnumCache<GachaTitleColorType>();
        AddEnumCache<GlobalGvgGroupType>();
        AddEnumCache<GlobalGvgPhaseType>();
        AddEnumCache<GrowthPackBuffType>();
        AddEnumCache<GuerrillaLotteryGroupType>();
        AddEnumCache<GuildActivityPolicyType>();
        AddEnumCache<GuildRaidAutoOpenFailType>();
        AddEnumCache<GuildRaidBossType>();
        AddEnumCache<GuildRankingType>();
        AddEnumCache<GuildTowerCharacterConditionType>();
        AddEnumCache<GuildTowerEntryType>();
        AddEnumCache<GuildTowerRankingType>();
        AddEnumCache<GvgCastleState>();
        AddEnumCache<GvgDialogType>();
        AddEnumCache<HeaderMenuButtonType>();
        AddEnumCache<HelpParameterType>();
        AddEnumCache<HubClientState>();
        AddEnumCache<IconMaterialType>();
        AddEnumCache<IconPlateType>();
        AddEnumCache<ImagePositionFormatType>();
        AddEnumCache<InquiryButtonType>();
        AddEnumCache<ItemImageSizeType>();
        AddEnumCache<ItemRarityFlags>();
        AddEnumCache<ItemType>();
        AddEnumCache<JingleType>();
        AddEnumCache<JobFlags>();
        AddEnumCache<KoiniwaAccountLinkType>();
        AddEnumCache<LanguageType>();
        AddEnumCache<LeadLockEquipmentDialogType>();
        AddEnumCache<LegendLeagueClassType>();
        AddEnumCache<LegendLeagueIconRewardDisplayTabType>();
        AddEnumCache<LerpType>();
        AddEnumCache<LimitedEventType>();
        AddEnumCache<LocalNotificationSendType>();
        AddEnumCache<LocalNotificationType>();
        AddEnumCache<LocalRaidEventType>();
        AddEnumCache<LocalRaidQuestGroupType>();
        AddEnumCache<LocalRaidQuestType>();
        AddEnumCache<LocalRaidRoomConditionsType>();
        AddEnumCache<LockEquipmentActionType>();
        AddEnumCache<LockEquipmentDeckType>();
        AddEnumCache<LockIconSizeType>();
        AddEnumCache<LoopAnimationType>();
        AddEnumCache<LotteryType>();
        AddEnumCache<MaintenanceAreaType>();
        AddEnumCache<MaintenanceFunctionType>();
        AddEnumCache<MaintenancePlatformType>();
        AddEnumCache<MaintenanceServerType>();
        AddEnumCache<ManagementNewUserType>();
        AddEnumCache<MatchlessSacredTreasureExpItemType>();
        AddEnumCache<MemoryLogType>();
        AddEnumCache<MissionAchievementType>();
        AddEnumCache<MissionActivityRewardStatusType>();
        AddEnumCache<MissionActivityRewardType>();
        AddEnumCache<MissionFocusType>();
        AddEnumCache<MissionGroupType>();
        AddEnumCache<MissionStatusType>();
        AddEnumCache<MissionTransitionDestinationType>();
        AddEnumCache<MissionType>();
        AddEnumCache<MonologueTextType>();
        AddEnumCache<NoticeAccessType>();
        AddEnumCache<NoticeButtonImageType>();
        AddEnumCache<NoticeCategoryType>();
        AddEnumCache<NotificationMessageType>();
        AddEnumCache<NotificationType>();
        AddEnumCache<OpenCommandType>();
        AddEnumCache<OpenContentType>();
        AddEnumCache<OrtegaEnvironment>();
        AddEnumCache<PanelTabType>();
        AddEnumCache<ParameterType>();
        AddEnumCache<PlayerGuildPositionType>();
        AddEnumCache<PlayerOrderType>();
        AddEnumCache<PlayerRankingIconType>();
        AddEnumCache<PlayerRankingType>();
        AddEnumCache<PlayerSettingsType>();
        AddEnumCache<PresentType>();
        AddEnumCache<PrivacySettingsType>();
        AddEnumCache<PurchaseAgeGroupType>();
        AddEnumCache<PurchaseStateType>();
        AddEnumCache<PvpRankingRewardType>();
        AddEnumCache<QuestDifficultyType>();
        AddEnumCache<QuestQuickExecuteType>();
        AddEnumCache<QuestQuickTicketRewardFlags>();
        AddEnumCache<QuestQuickTicketType>();
        AddEnumCache<RankingDataType>();
        AddEnumCache<RankingGroupType>();
        AddEnumCache<RankingType>();
        AddEnumCache<RankUpType>();
        AddEnumCache<RawDataDownloadType>();
        AddEnumCache<RecitationTextType>();
        AddEnumCache<RecruitGuildMemberSearchType>();
        AddEnumCache<RemoteNotificationType>();
        AddEnumCache<ResolutionType>();
        AddEnumCache<RewardMostElementType>();
        AddEnumCache<RewardRarityPointGroupType>();
        AddEnumCache<RewardTreasureBoxStatus>();
        AddEnumCache<RewardType>();
        AddEnumCache<SacredTreasureType>();
        AddEnumCache<ScenarioCharacterBlinkAssetType>();
        AddEnumCache<SceneTransition>();
        AddEnumCache<SecondaryFrameType>();
        AddEnumCache<SeType>();
        AddEnumCache<ShareLogoType>();
        AddEnumCache<ShopBuyLimitType>();
        AddEnumCache<ShopChargeBonusMissionType>();
        AddEnumCache<ShopCountResetType>();
        AddEnumCache<ShopCurrencyMissionType>();
        AddEnumCache<ShopDisplayPeriodType>();
        AddEnumCache<ShopGuerrillaPackOpenType>();
        AddEnumCache<ShopGuerrillaPackRankType>();
        AddEnumCache<ShopProductGrowthPackType>();
        AddEnumCache<ShopProductType>();
        AddEnumCache<ShopProductUiType>();
        AddEnumCache<SimpleDescriptionButtonType>();
        AddEnumCache<SkillCategory>();
        AddEnumCache<SkillEnhancementItemFlag>();
        AddEnumCache<SkillType>();
        AddEnumCache<SnsType>();
        AddEnumCache<SphereSlotStatus>();
        AddEnumCache<SphereType>();
        AddEnumCache<StartEndTimeZoneType>();
        AddEnumCache<SubSkillResultType>();
        AddEnumCache<SubSkillType>();
        AddEnumCache<SystemChatMessageIdType>();
        AddEnumCache<SystemChatType>();
        AddEnumCache<TargetType>();
        AddEnumCache<TextColorType>();
        AddEnumCache<TextOutlineType>();
        AddEnumCache<TextRarityType>();
        AddEnumCache<TimelineType>();
        AddEnumCache<TimeServerType>();
        AddEnumCache<TitleLogoType>();
        AddEnumCache<TowerBattleBossType>();
        AddEnumCache<TowerBattleRewardsType>();
        AddEnumCache<TowerType>();
        AddEnumCache<TradeShopAutoUpdateType>();
        AddEnumCache<TradeShopType>();
        AddEnumCache<TrainingItemType>();
        AddEnumCache<TrainingResultType>();
        AddEnumCache<TransferSpotType>();
        AddEnumCache<TransitionState>();
        AddEnumCache<TreasureChestItemListType>();
        AddEnumCache<TreasureChestKeyType>();
        AddEnumCache<TreasureChestLotteryType>();
        AddEnumCache<TutorialArrowType>();
        AddEnumCache<TutorialButtonType>();
        AddEnumCache<TutorialEndConditionType>();
        AddEnumCache<TutorialEventType>();
        AddEnumCache<TutorialFinishType>();
        AddEnumCache<TutorialHighlightType>();
        AddEnumCache<TutorialMessagePositionType>();
        AddEnumCache<TutorialStartConditionType>();
        AddEnumCache<TutorialStartType>();
        AddEnumCache<TutorialViewType>();
        AddEnumCache<UIPushType>();
        AddEnumCache<UnitIconType>();
        AddEnumCache<UnitType>();
        AddEnumCache<UnlockCharacterDetailVoiceType>();
        AddEnumCache<UserSettingsType>();
        AddEnumCache<ViewTransitionType>();
        AddEnumCache<VipPrivilegeType>();
        AddEnumCache<VoiceVolumeFadeType>();
    }

    private static void AddEnumCache<T>() where T : struct, Enum
    {
        var values = Enum.GetValues<T>();
        var dict = new Dictionary<long, string>();
        foreach (var value in values)
        {
            dict[Convert.ToInt64(value)] = value.ToString();
        }
        _enumValueCache.Add(typeof(T).Name, dict);
    }
    
    public static string? GetEnumValue(string enumName, long value)
    {
        return _enumValueCache.TryGetValue(enumName, out var dict)
            ? dict.TryGetValue(value, out var result) ? result : value.ToString()
            : value.ToString();
    }
}